Using TensorFlow backend.
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/dxu/anaconda3/envs/dnn3.6/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Number of used CPUs: 28
file_path is a direction
File list:
../../data/linear/train/more_varis.csv
../../data/linear/train/2_varis.csv
../../data/linear/train/3_varis.csv
#Number of datas: 1000000
Number of data: 1000000
Number of unique input tokens: 24
Number of unique target tokens: 26
Max sequence length of inputs: 100
Max sequence length of targets: 37
WARNING:tensorflow:From /home/dxu/.local/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:72: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From /home/dxu/.local/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:515: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-01-10 07:31:25.348351: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-01-10 07:31:25.370269: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400085000 Hz
2020-01-10 07:31:25.373534: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a5e6e09910 executing computations on platform Host. Devices:
2020-01-10 07:31:25.373564: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-01-10 07:31:25.374947: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2020-01-10 07:31:26.136797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:09:00.0
2020-01-10 07:31:26.137079: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-01-10 07:31:26.139276: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-01-10 07:31:26.141250: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-01-10 07:31:26.141579: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-01-10 07:31:26.143970: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-01-10 07:31:26.145218: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-01-10 07:31:26.150426: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-01-10 07:31:26.152209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-01-10 07:31:26.152258: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-01-10 07:31:26.376729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-01-10 07:31:26.376780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-01-10 07:31:26.376789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-01-10 07:31:26.379553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/device:GPU:0 with 11439 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:09:00.0, compute capability: 6.1)
2020-01-10 07:31:26.381837: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a5ecd41570 executing computations on platform CUDA. Devices:
2020-01-10 07:31:26.381858: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): TITAN Xp, Compute Capability 6.1
WARNING:tensorflow:From /home/dxu/.local/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:4048: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

2020-01-10 07:31:27.254180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:09:00.0
2020-01-10 07:31:27.254248: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-01-10 07:31:27.254286: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-01-10 07:31:27.254306: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-01-10 07:31:27.254325: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-01-10 07:31:27.254343: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-01-10 07:31:27.254362: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-01-10 07:31:27.254381: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-01-10 07:31:27.256044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-01-10 07:31:27.256079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-01-10 07:31:27.256088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-01-10 07:31:27.256095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-01-10 07:31:27.257761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/device:GPU:0 with 11439 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:09:00.0, compute capability: 6.1)
WARNING:tensorflow:From /home/dxu/.local/lib/python3.6/site-packages/keras/optimizers.py:782: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From /home/dxu/.local/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3218: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/dxu/mba_workspace/ai-mba/model/lstm/utils.py:119: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, None, 24)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, None, 26)     0                                            
__________________________________________________________________________________________________
cu_dnnlstm_1 (CuDNNLSTM)        [(None, 256), (None, 288768      input_1[0][0]                    
__________________________________________________________________________________________________
cu_dnnlstm_2 (CuDNNLSTM)        [(None, None, 256),  290816      input_2[0][0]                    
                                                                 cu_dnnlstm_1[0][1]               
                                                                 cu_dnnlstm_1[0][2]               
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, None, 26)     6682        cu_dnnlstm_2[0][0]               
==================================================================================================
Total params: 586,266
Trainable params: 586,266
Non-trainable params: 0
__________________________________________________________________________________________________
WARNING:tensorflow:From /home/dxu/.local/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:984: The name tf.assign_add is deprecated. Please use tf.compat.v1.assign_add instead.

Epoch 1/1000
2020-01-10 07:31:30.211165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: TITAN Xp major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:09:00.0
2020-01-10 07:31:30.211288: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2020-01-10 07:31:30.211318: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-01-10 07:31:30.211347: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2020-01-10 07:31:30.211374: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2020-01-10 07:31:30.211401: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2020-01-10 07:31:30.211430: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2020-01-10 07:31:30.211458: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2020-01-10 07:31:30.213145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2020-01-10 07:31:30.213222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-01-10 07:31:30.213233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2020-01-10 07:31:30.213241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2020-01-10 07:31:30.214989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11439 MB memory) -> physical GPU (device: 0, name: TITAN Xp, pci bus id: 0000:09:00.0, compute capability: 6.1)
2020-01-10 07:31:31.934434: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2020-01-10 07:31:32.253543: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
 - 63s - loss: 0.3505 - match_rate: 0.0046 - val_loss: 0.1905 - val_match_rate: 0.0068
Epoch 2/1000
 - 59s - loss: 0.1800 - match_rate: 0.0132 - val_loss: 0.1666 - val_match_rate: 0.0179
Epoch 3/1000
 - 61s - loss: 0.1452 - match_rate: 0.0302 - val_loss: 0.1283 - val_match_rate: 0.0454
Epoch 4/1000
 - 61s - loss: 0.1175 - match_rate: 0.0687 - val_loss: 0.1087 - val_match_rate: 0.0898
Epoch 5/1000
 - 63s - loss: 0.0960 - match_rate: 0.1348 - val_loss: 0.0881 - val_match_rate: 0.1732
Epoch 6/1000
 - 62s - loss: 0.0804 - match_rate: 0.2140 - val_loss: 0.0757 - val_match_rate: 0.2393
Epoch 7/1000
 - 62s - loss: 0.0692 - match_rate: 0.2920 - val_loss: 0.0628 - val_match_rate: 0.3478
Epoch 8/1000
 - 62s - loss: 0.0595 - match_rate: 0.3747 - val_loss: 0.0540 - val_match_rate: 0.4320
Epoch 9/1000
 - 63s - loss: 0.0520 - match_rate: 0.4494 - val_loss: 0.0482 - val_match_rate: 0.4941
Epoch 10/1000
 - 63s - loss: 0.0453 - match_rate: 0.5213 - val_loss: 0.0425 - val_match_rate: 0.5554
Epoch 11/1000
 - 62s - loss: 0.0403 - match_rate: 0.5784 - val_loss: 0.0401 - val_match_rate: 0.5854
Epoch 12/1000
 - 63s - loss: 0.0360 - match_rate: 0.6273 - val_loss: 0.0384 - val_match_rate: 0.5958
Epoch 13/1000
 - 63s - loss: 0.0325 - match_rate: 0.6686 - val_loss: 0.0332 - val_match_rate: 0.6576
Epoch 14/1000
 - 63s - loss: 0.0294 - match_rate: 0.7074 - val_loss: 0.0274 - val_match_rate: 0.7327
Epoch 15/1000
 - 63s - loss: 0.0266 - match_rate: 0.7412 - val_loss: 0.0265 - val_match_rate: 0.7407
Epoch 16/1000
 - 62s - loss: 0.0244 - match_rate: 0.7684 - val_loss: 0.0228 - val_match_rate: 0.7938
Epoch 17/1000
 - 62s - loss: 0.0224 - match_rate: 0.7928 - val_loss: 0.0233 - val_match_rate: 0.7847
Epoch 18/1000
 - 62s - loss: 0.0209 - match_rate: 0.8104 - val_loss: 0.0210 - val_match_rate: 0.8091
Epoch 19/1000
 - 63s - loss: 0.0195 - match_rate: 0.8274 - val_loss: 0.0199 - val_match_rate: 0.8242
Epoch 20/1000
 - 62s - loss: 0.0185 - match_rate: 0.8385 - val_loss: 0.0190 - val_match_rate: 0.8336
Epoch 21/1000
 - 63s - loss: 0.0175 - match_rate: 0.8503 - val_loss: 0.0186 - val_match_rate: 0.8377
Epoch 22/1000
 - 63s - loss: 0.0165 - match_rate: 0.8606 - val_loss: 0.0167 - val_match_rate: 0.8602
Epoch 23/1000
 - 62s - loss: 0.0158 - match_rate: 0.8696 - val_loss: 0.0167 - val_match_rate: 0.8586
Epoch 24/1000
 - 63s - loss: 0.0152 - match_rate: 0.8763 - val_loss: 0.0159 - val_match_rate: 0.8703
Epoch 25/1000
 - 61s - loss: 0.0144 - match_rate: 0.8846 - val_loss: 0.0154 - val_match_rate: 0.8730
Epoch 26/1000
 - 63s - loss: 0.0140 - match_rate: 0.8887 - val_loss: 0.0165 - val_match_rate: 0.8587
Epoch 27/1000
 - 63s - loss: 0.0135 - match_rate: 0.8939 - val_loss: 0.0145 - val_match_rate: 0.8832
Epoch 28/1000
 - 62s - loss: 0.0131 - match_rate: 0.8972 - val_loss: 0.0126 - val_match_rate: 0.9084
Epoch 29/1000
 - 63s - loss: 0.0127 - match_rate: 0.9019 - val_loss: 0.0133 - val_match_rate: 0.8972
Epoch 30/1000
 - 62s - loss: 0.0122 - match_rate: 0.9061 - val_loss: 0.0125 - val_match_rate: 0.9075
Epoch 31/1000
 - 62s - loss: 0.0120 - match_rate: 0.9087 - val_loss: 0.0128 - val_match_rate: 0.9034
Epoch 32/1000
 - 62s - loss: 0.0117 - match_rate: 0.9111 - val_loss: 0.0125 - val_match_rate: 0.9071
Epoch 33/1000
 - 62s - loss: 0.0113 - match_rate: 0.9150 - val_loss: 0.0120 - val_match_rate: 0.9117
Epoch 34/1000
 - 62s - loss: 0.0110 - match_rate: 0.9175 - val_loss: 0.0116 - val_match_rate: 0.9148
Epoch 35/1000
 - 62s - loss: 0.0107 - match_rate: 0.9199 - val_loss: 0.0111 - val_match_rate: 0.9210
Epoch 36/1000
 - 62s - loss: 0.0104 - match_rate: 0.9224 - val_loss: 0.0115 - val_match_rate: 0.9149
Epoch 37/1000
 - 62s - loss: 0.0101 - match_rate: 0.9248 - val_loss: 0.0130 - val_match_rate: 0.8928
Epoch 38/1000
 - 63s - loss: 0.0099 - match_rate: 0.9265 - val_loss: 0.0100 - val_match_rate: 0.9307
Epoch 39/1000
 - 63s - loss: 0.0096 - match_rate: 0.9285 - val_loss: 0.0105 - val_match_rate: 0.9239
Epoch 40/1000
 - 63s - loss: 0.0094 - match_rate: 0.9297 - val_loss: 0.0107 - val_match_rate: 0.9200
Epoch 41/1000
 - 63s - loss: 0.0092 - match_rate: 0.9320 - val_loss: 0.0101 - val_match_rate: 0.9269
Epoch 42/1000
 - 63s - loss: 0.0090 - match_rate: 0.9338 - val_loss: 0.0103 - val_match_rate: 0.9240
Epoch 43/1000
 - 62s - loss: 0.0088 - match_rate: 0.9349 - val_loss: 0.0098 - val_match_rate: 0.9299
Epoch 44/1000
 - 64s - loss: 0.0086 - match_rate: 0.9362 - val_loss: 0.0096 - val_match_rate: 0.9319
Epoch 45/1000
 - 63s - loss: 0.0084 - match_rate: 0.9374 - val_loss: 0.0099 - val_match_rate: 0.9279
Epoch 46/1000
 - 64s - loss: 0.0082 - match_rate: 0.9385 - val_loss: 0.0090 - val_match_rate: 0.9377
Epoch 47/1000
 - 63s - loss: 0.0081 - match_rate: 0.9391 - val_loss: 0.0099 - val_match_rate: 0.9247
Epoch 48/1000
 - 62s - loss: 0.0079 - match_rate: 0.9403 - val_loss: 0.0097 - val_match_rate: 0.9278
Epoch 49/1000
 - 63s - loss: 0.0078 - match_rate: 0.9409 - val_loss: 0.0087 - val_match_rate: 0.9399
Epoch 50/1000
 - 62s - loss: 0.0076 - match_rate: 0.9426 - val_loss: 0.0089 - val_match_rate: 0.9372
Epoch 51/1000
 - 62s - loss: 0.0075 - match_rate: 0.9431 - val_loss: 0.0087 - val_match_rate: 0.9403
Epoch 52/1000
 - 63s - loss: 0.0073 - match_rate: 0.9438 - val_loss: 0.0093 - val_match_rate: 0.9314
Epoch 53/1000
 - 63s - loss: 0.0072 - match_rate: 0.9448 - val_loss: 0.0090 - val_match_rate: 0.9359
Epoch 54/1000
 - 62s - loss: 0.0070 - match_rate: 0.9454 - val_loss: 0.0084 - val_match_rate: 0.9396
Epoch 55/1000
 - 62s - loss: 0.0069 - match_rate: 0.9467 - val_loss: 0.0083 - val_match_rate: 0.9409
Epoch 56/1000
 - 63s - loss: 0.0067 - match_rate: 0.9471 - val_loss: 0.0082 - val_match_rate: 0.9422
Epoch 57/1000
 - 64s - loss: 0.0066 - match_rate: 0.9478 - val_loss: 0.0080 - val_match_rate: 0.9428
Epoch 58/1000
 - 62s - loss: 0.0066 - match_rate: 0.9479 - val_loss: 0.0084 - val_match_rate: 0.9419
Epoch 59/1000
 - 63s - loss: 0.0064 - match_rate: 0.9494 - val_loss: 0.0079 - val_match_rate: 0.9450
Epoch 60/1000
 - 64s - loss: 0.0062 - match_rate: 0.9502 - val_loss: 0.0094 - val_match_rate: 0.9302
Epoch 61/1000
 - 63s - loss: 0.0062 - match_rate: 0.9492 - val_loss: 0.0076 - val_match_rate: 0.9472
Epoch 62/1000
 - 63s - loss: 0.0060 - match_rate: 0.9507 - val_loss: 0.0084 - val_match_rate: 0.9368
Epoch 63/1000
 - 63s - loss: 0.0059 - match_rate: 0.9513 - val_loss: 0.0078 - val_match_rate: 0.9428
Epoch 64/1000
 - 63s - loss: 0.0058 - match_rate: 0.9515 - val_loss: 0.0077 - val_match_rate: 0.9461
Epoch 65/1000
 - 62s - loss: 0.0057 - match_rate: 0.9521 - val_loss: 0.0082 - val_match_rate: 0.9410
Epoch 66/1000
 - 64s - loss: 0.0056 - match_rate: 0.9528 - val_loss: 0.0077 - val_match_rate: 0.9438
Epoch 67/1000
 - 63s - loss: 0.0055 - match_rate: 0.9533 - val_loss: 0.0073 - val_match_rate: 0.9490
Epoch 68/1000
 - 64s - loss: 0.0054 - match_rate: 0.9538 - val_loss: 0.0080 - val_match_rate: 0.9401
Epoch 69/1000
 - 63s - loss: 0.0053 - match_rate: 0.9548 - val_loss: 0.0078 - val_match_rate: 0.9430
Epoch 70/1000
 - 64s - loss: 0.0052 - match_rate: 0.9544 - val_loss: 0.0081 - val_match_rate: 0.9397
Epoch 71/1000
 - 62s - loss: 0.0051 - match_rate: 0.9553 - val_loss: 0.0078 - val_match_rate: 0.9445
Epoch 72/1000
 - 64s - loss: 0.0051 - match_rate: 0.9553 - val_loss: 0.0074 - val_match_rate: 0.9470
Epoch 73/1000
 - 64s - loss: 0.0049 - match_rate: 0.9563 - val_loss: 0.0071 - val_match_rate: 0.9513
Epoch 74/1000
 - 63s - loss: 0.0049 - match_rate: 0.9566 - val_loss: 0.0073 - val_match_rate: 0.9489
Epoch 75/1000
 - 64s - loss: 0.0048 - match_rate: 0.9566 - val_loss: 0.0072 - val_match_rate: 0.9516
Epoch 76/1000
 - 64s - loss: 0.0047 - match_rate: 0.9573 - val_loss: 0.0075 - val_match_rate: 0.9448
Epoch 77/1000
 - 63s - loss: 0.0046 - match_rate: 0.9578 - val_loss: 0.0081 - val_match_rate: 0.9419
Epoch 78/1000
 - 63s - loss: 0.0046 - match_rate: 0.9577 - val_loss: 0.0073 - val_match_rate: 0.9499
Epoch 79/1000
 - 63s - loss: 0.0045 - match_rate: 0.9585 - val_loss: 0.0074 - val_match_rate: 0.9489
Epoch 80/1000
 - 63s - loss: 0.0044 - match_rate: 0.9588 - val_loss: 0.0068 - val_match_rate: 0.9537
Epoch 81/1000
 - 63s - loss: 0.0043 - match_rate: 0.9595 - val_loss: 0.0068 - val_match_rate: 0.9540
Epoch 82/1000
 - 64s - loss: 0.0043 - match_rate: 0.9597 - val_loss: 0.0071 - val_match_rate: 0.9522
Epoch 83/1000
 - 64s - loss: 0.0042 - match_rate: 0.9602 - val_loss: 0.0081 - val_match_rate: 0.9404
Epoch 84/1000
 - 63s - loss: 0.0042 - match_rate: 0.9605 - val_loss: 0.0077 - val_match_rate: 0.9452
Epoch 85/1000
 - 63s - loss: 0.0041 - match_rate: 0.9611 - val_loss: 0.0075 - val_match_rate: 0.9496
Epoch 86/1000
 - 64s - loss: 0.0041 - match_rate: 0.9610 - val_loss: 0.0071 - val_match_rate: 0.9512
Epoch 87/1000
 - 63s - loss: 0.0039 - match_rate: 0.9618 - val_loss: 0.0072 - val_match_rate: 0.9516
Epoch 88/1000
 - 64s - loss: 0.0039 - match_rate: 0.9618 - val_loss: 0.0076 - val_match_rate: 0.9489
Epoch 89/1000
 - 63s - loss: 0.0038 - match_rate: 0.9628 - val_loss: 0.0073 - val_match_rate: 0.9514
Epoch 90/1000
 - 63s - loss: 0.0038 - match_rate: 0.9622 - val_loss: 0.0075 - val_match_rate: 0.9494
Epoch 91/1000
 - 64s - loss: 0.0037 - match_rate: 0.9633 - val_loss: 0.0075 - val_match_rate: 0.9512
Epoch 92/1000
 - 63s - loss: 0.0036 - match_rate: 0.9638 - val_loss: 0.0073 - val_match_rate: 0.9525
Epoch 93/1000
 - 63s - loss: 0.0036 - match_rate: 0.9635 - val_loss: 0.0077 - val_match_rate: 0.9484
Epoch 94/1000
 - 64s - loss: 0.0035 - match_rate: 0.9643 - val_loss: 0.0076 - val_match_rate: 0.9524
Epoch 95/1000
 - 64s - loss: 0.0036 - match_rate: 0.9640 - val_loss: 0.0078 - val_match_rate: 0.9468
Epoch 96/1000
 - 63s - loss: 0.0035 - match_rate: 0.9648 - val_loss: 0.0071 - val_match_rate: 0.9573
Epoch 97/1000
 - 65s - loss: 0.0035 - match_rate: 0.9650 - val_loss: 0.0075 - val_match_rate: 0.9522
Epoch 98/1000
 - 63s - loss: 0.0034 - match_rate: 0.9657 - val_loss: 0.0072 - val_match_rate: 0.9558
Epoch 99/1000
 - 63s - loss: 0.0034 - match_rate: 0.9651 - val_loss: 0.0075 - val_match_rate: 0.9536
Epoch 100/1000
 - 63s - loss: 0.0033 - match_rate: 0.9662 - val_loss: 0.0073 - val_match_rate: 0.9555
Epoch 101/1000
 - 63s - loss: 0.0032 - match_rate: 0.9665 - val_loss: 0.0076 - val_match_rate: 0.9537
Epoch 102/1000
 - 64s - loss: 0.0032 - match_rate: 0.9668 - val_loss: 0.0077 - val_match_rate: 0.9520
Epoch 103/1000
 - 63s - loss: 0.0034 - match_rate: 0.9661 - val_loss: 0.0077 - val_match_rate: 0.9522
Epoch 104/1000
 - 64s - loss: 0.0033 - match_rate: 0.9661 - val_loss: 0.0077 - val_match_rate: 0.9517
Epoch 105/1000
 - 64s - loss: 0.0030 - match_rate: 0.9684 - val_loss: 0.0075 - val_match_rate: 0.9572
Epoch 106/1000
 - 63s - loss: 0.0030 - match_rate: 0.9678 - val_loss: 0.0078 - val_match_rate: 0.9555
Epoch 107/1000
 - 64s - loss: 0.0030 - match_rate: 0.9686 - val_loss: 0.0077 - val_match_rate: 0.9558
Epoch 108/1000
 - 64s - loss: 0.0029 - match_rate: 0.9684 - val_loss: 0.0078 - val_match_rate: 0.9547
Epoch 109/1000
 - 63s - loss: 0.0029 - match_rate: 0.9693 - val_loss: 0.0078 - val_match_rate: 0.9544
Epoch 110/1000
 - 63s - loss: 0.0029 - match_rate: 0.9689 - val_loss: 0.0081 - val_match_rate: 0.9521
Epoch 111/1000
 - 62s - loss: 0.0029 - match_rate: 0.9692 - val_loss: 0.0078 - val_match_rate: 0.9559
Epoch 112/1000
 - 65s - loss: 0.0028 - match_rate: 0.9697 - val_loss: 0.0081 - val_match_rate: 0.9533
Epoch 113/1000
 - 63s - loss: 0.0029 - match_rate: 0.9693 - val_loss: 0.0081 - val_match_rate: 0.9533
Epoch 114/1000
 - 64s - loss: 0.0027 - match_rate: 0.9708 - val_loss: 0.0078 - val_match_rate: 0.9576
Epoch 115/1000
 - 63s - loss: 0.0027 - match_rate: 0.9702 - val_loss: 0.0080 - val_match_rate: 0.9545
Epoch 116/1000
 - 63s - loss: 0.0026 - match_rate: 0.9710 - val_loss: 0.0083 - val_match_rate: 0.9531
Epoch 117/1000
 - 64s - loss: 0.0026 - match_rate: 0.9710 - val_loss: 0.0080 - val_match_rate: 0.9566
Epoch 118/1000
 - 64s - loss: 0.0026 - match_rate: 0.9717 - val_loss: 0.0082 - val_match_rate: 0.9544
Epoch 119/1000
 - 64s - loss: 0.0026 - match_rate: 0.9714 - val_loss: 0.0092 - val_match_rate: 0.9439
Epoch 120/1000
 - 64s - loss: 0.0025 - match_rate: 0.9726 - val_loss: 0.0087 - val_match_rate: 0.9508
Epoch 121/1000
 - 63s - loss: 0.0026 - match_rate: 0.9714 - val_loss: 0.0083 - val_match_rate: 0.9553
Epoch 122/1000
 - 63s - loss: 0.0025 - match_rate: 0.9726 - val_loss: 0.0084 - val_match_rate: 0.9547
Epoch 123/1000
 - 63s - loss: 0.0026 - match_rate: 0.9722 - val_loss: 0.0086 - val_match_rate: 0.9551
Epoch 124/1000
 - 64s - loss: 0.0025 - match_rate: 0.9727 - val_loss: 0.0086 - val_match_rate: 0.9532
Epoch 125/1000
 - 64s - loss: 0.0024 - match_rate: 0.9730 - val_loss: 0.0084 - val_match_rate: 0.9563
Epoch 126/1000
 - 64s - loss: 0.0024 - match_rate: 0.9730 - val_loss: 0.0086 - val_match_rate: 0.9548
Epoch 127/1000
 - 64s - loss: 0.0024 - match_rate: 0.9735 - val_loss: 0.0090 - val_match_rate: 0.9533
Epoch 128/1000
 - 62s - loss: 0.0014 - match_rate: 0.9846 - val_loss: 0.0078 - val_match_rate: 0.9625
Epoch 129/1000
 - 63s - loss: 0.0012 - match_rate: 0.9865 - val_loss: 0.0080 - val_match_rate: 0.9627
Epoch 130/1000
 - 65s - loss: 0.0012 - match_rate: 0.9872 - val_loss: 0.0082 - val_match_rate: 0.9626
Epoch 131/1000
 - 64s - loss: 0.0011 - match_rate: 0.9878 - val_loss: 0.0083 - val_match_rate: 0.9627
Epoch 132/1000
 - 64s - loss: 0.0011 - match_rate: 0.9882 - val_loss: 0.0084 - val_match_rate: 0.9628
Epoch 133/1000
 - 65s - loss: 0.0010 - match_rate: 0.9887 - val_loss: 0.0085 - val_match_rate: 0.9628
Epoch 134/1000
 - 64s - loss: 0.0010 - match_rate: 0.9891 - val_loss: 0.0087 - val_match_rate: 0.9629
Epoch 135/1000
 - 64s - loss: 9.7050e-04 - match_rate: 0.9895 - val_loss: 0.0088 - val_match_rate: 0.9628
Epoch 136/1000
 - 64s - loss: 9.4302e-04 - match_rate: 0.9898 - val_loss: 0.0089 - val_match_rate: 0.9626
Epoch 137/1000
 - 64s - loss: 9.1598e-04 - match_rate: 0.9902 - val_loss: 0.0090 - val_match_rate: 0.9624
Epoch 138/1000
 - 63s - loss: 8.8907e-04 - match_rate: 0.9905 - val_loss: 0.0091 - val_match_rate: 0.9625
Epoch 139/1000
 - 64s - loss: 8.6451e-04 - match_rate: 0.9908 - val_loss: 0.0093 - val_match_rate: 0.9621
Epoch 140/1000
 - 64s - loss: 8.4442e-04 - match_rate: 0.9910 - val_loss: 0.0094 - val_match_rate: 0.9625
Epoch 141/1000
 - 64s - loss: 8.2684e-04 - match_rate: 0.9913 - val_loss: 0.0094 - val_match_rate: 0.9624
Epoch 142/1000
 - 64s - loss: 8.0465e-04 - match_rate: 0.9915 - val_loss: 0.0096 - val_match_rate: 0.9622
Epoch 143/1000
 - 64s - loss: 7.8974e-04 - match_rate: 0.9917 - val_loss: 0.0096 - val_match_rate: 0.9621
Epoch 144/1000
 - 63s - loss: 6.8072e-04 - match_rate: 0.9931 - val_loss: 0.0097 - val_match_rate: 0.9626
Epoch 145/1000
 - 64s - loss: 6.6223e-04 - match_rate: 0.9933 - val_loss: 0.0098 - val_match_rate: 0.9625
Epoch 146/1000
 - 64s - loss: 6.5261e-04 - match_rate: 0.9934 - val_loss: 0.0098 - val_match_rate: 0.9623
Epoch 147/1000
 - 63s - loss: 6.4395e-04 - match_rate: 0.9935 - val_loss: 0.0099 - val_match_rate: 0.9623
Epoch 148/1000
 - 64s - loss: 6.3594e-04 - match_rate: 0.9936 - val_loss: 0.0100 - val_match_rate: 0.9624
Epoch 149/1000
 - 64s - loss: 6.2863e-04 - match_rate: 0.9937 - val_loss: 0.0100 - val_match_rate: 0.9624
Epoch 150/1000
 - 64s - loss: 6.0424e-04 - match_rate: 0.9941 - val_loss: 0.0100 - val_match_rate: 0.9623
Epoch 151/1000
 - 64s - loss: 6.0123e-04 - match_rate: 0.9941 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 152/1000
 - 63s - loss: 5.9947e-04 - match_rate: 0.9941 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 153/1000
 - 64s - loss: 5.9783e-04 - match_rate: 0.9941 - val_loss: 0.0101 - val_match_rate: 0.9623
Epoch 154/1000
 - 64s - loss: 5.9639e-04 - match_rate: 0.9941 - val_loss: 0.0101 - val_match_rate: 0.9623
Epoch 155/1000
 - 64s - loss: 5.9062e-04 - match_rate: 0.9942 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 156/1000
 - 64s - loss: 5.9030e-04 - match_rate: 0.9942 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 157/1000
 - 64s - loss: 5.8990e-04 - match_rate: 0.9942 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 158/1000
 - 63s - loss: 5.8971e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 159/1000
 - 63s - loss: 5.8929e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 160/1000
 - 63s - loss: 5.8806e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 161/1000
 - 64s - loss: 5.8783e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 162/1000
 - 64s - loss: 5.8786e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 163/1000
 - 64s - loss: 5.8781e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 164/1000
 - 63s - loss: 5.8766e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 165/1000
 - 64s - loss: 5.8740e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 166/1000
 - 64s - loss: 5.8750e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 167/1000
 - 64s - loss: 5.8751e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 168/1000
 - 65s - loss: 5.8757e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 169/1000
 - 64s - loss: 5.8755e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 170/1000
 - 64s - loss: 5.8741e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 171/1000
 - 65s - loss: 5.8732e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 172/1000
 - 64s - loss: 5.8731e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 173/1000
 - 64s - loss: 5.8734e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 174/1000
 - 65s - loss: 5.8739e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 175/1000
 - 64s - loss: 5.8740e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 176/1000
 - 63s - loss: 5.8752e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 177/1000
 - 64s - loss: 5.8714e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 178/1000
 - 63s - loss: 5.8728e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 179/1000
 - 65s - loss: 5.8741e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 180/1000
 - 64s - loss: 5.8734e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 181/1000
 - 63s - loss: 5.8731e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 182/1000
 - 64s - loss: 5.8736e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 183/1000
 - 63s - loss: 5.8728e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 184/1000
 - 64s - loss: 5.8716e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 185/1000
 - 64s - loss: 5.8742e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 186/1000
 - 63s - loss: 5.8742e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
Epoch 187/1000
 - 64s - loss: 5.8714e-04 - match_rate: 0.9943 - val_loss: 0.0101 - val_match_rate: 0.9622
/home/dxu/.local/lib/python3.6/site-packages/keras/engine/network.py:872: UserWarning: Layer cu_dnnlstm_2 was passed non-serializable keyword arguments: {'initial_state': [<tf.Tensor 'cu_dnnlstm_1/strided_slice_16:0' shape=(?, 256) dtype=float32>, <tf.Tensor 'cu_dnnlstm_1/strided_slice_17:0' shape=(?, 256) dtype=float32>]}. They will not be included in the serialized model (and thus will be missing at deserialization time).
  '. They will not be included '
